#!/usr/bin/ruby

# a(n) is the largest nonnegative integer m such that m - pi(m) >= pi(m)^(1 + 1/n).
# https://oeis.org/A334599

var prev = 2

for n in (1..20) {

    var lower = bsearch_ge(prev, 500*prev, {|k|
        var r = prime_count_upper(k)
        r**(1 + 1/n) <=> (k - r)
    })

    var upper = bsearch_ge(prev, 500*prev, {|k|
        var r = prime_count_lower(k)
        r**(1 + 1/n) <=> (k - r)
    })

    say "#{lower} < a(#{n}) < #{upper}"
    prev = lower;
}

__END__
64492 < a(4) < 67978
7067668 < a(5) < 7112169
744287193 < a(6) < 744819235
85280383480 < a(7) < 85286081628
10892922075377 < a(8) < 10893013633921
1553239463747816 < a(9) < 1553240634775666
246080326963804922 < a(10) < 246080342730454796
43047445068942615222 < a(11) < 43047462759121475571
8262178257963583032034 < a(12) < 8262178584638337935297
1729519242697405619666767 < a(13) < 1729519248856466080648807
392702298029148759151530273 < a(14) < 392712776944055478482475966
96244860765402129254421111539 < a(15) < 96246956870994176756273666977
25347123833257127196390718460343 < a(16) < 25347581096833853138718204714648
7144563645369359613501724049251462 < a(17) < 7144671780355779509224054835431667
2147565021120324505068139127187014177 < a(18) < 2147592597504759062268210338148532087
686146372954665028447280858753124722016 < a(19) < 686153921791182611901428447488418711879
232323822104657777486442538698834293691229 < a(20) < 232326031239990287969404432110290634742612
