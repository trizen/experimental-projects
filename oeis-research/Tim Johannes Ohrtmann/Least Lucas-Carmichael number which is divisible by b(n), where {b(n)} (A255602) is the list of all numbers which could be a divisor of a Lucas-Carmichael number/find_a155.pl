#!/usr/bin/perl

# a(n) = least Lucas-Carmichael number which is divisible by b(n), where {b(n)} (A255602) is the list of all numbers which could be a divisor of a Lucas-Carmichael number.
# https://oeis.org/A253598

# Upper-bounds:
#   a(155) <= 4131709859199     (confirmed)

use 5.014;
use ntheory qw(:all);

my $k = 471;
my $upper_bound = 4131709859199;
my @k_factors = factor($k);

my ($n, $t);

forsquarefree {

    if ($_ % 2) {
        $t = $_*$k + 1;

        #if (vecall {$t % ($_+1) == 0} @k_factors) {
        if ($t % 158 == 0 and $t % 4 == 0) {
            $n = $_;
            if (rand() < 0.001) {
                say "Progress: ", ($t-1)/$upper_bound * 100;
            }
            if (vecall { $t % ($_+1) == 0} factor($n)) {
                if (is_square_free($t-1)) {
                    die "Found: $k -> ", $t-1;
                }
            }
        }
    }

} 2, divint($upper_bound, $k);

__END__
 471:             4131709859199
 479:                   5058719
 481:                 505863371
 485:                    218735
 487:                   1901735
 489:              532100807679
 491:                    966779
 493:                  10260809
 497:                    194327
 499:                  14970499
 503:                    761039
 505:                     20705
 509:                  11682059
 511:                  50168447
 515:                    760655
 517:                     18095
 521:                  31276151
 523:                2316562079
 527:                  43383167
 533:                     29315
 535:                    265895
 541:                4992691535
 543:              377049487359
 547:               96078393179
 551:                     60059
 553:                     12719
 557:                 185551739
 559:                   8421335
 563:                  65094623
 565:                 129477095
 569:                    973559
 571:                  25149695
 577:                5778659039
 583:                      2915
 587:                   2416679
 589:                 116628479
 593:                  85595399
 595:                     31535
 597:                6304359999
 599:                  11141999
 601:                 434886605
 607:                  50561279
 611:                  22575839
 613:                1645919099
 617:                1100831039
 619:                  49124459
 623:                   1017359
 629:                   2276351
 631:                    798215
 635:                  78402815
 641:                1172426819
 643:                 178474295
 647:                   3354695
 649:                     46079
 651:                4962284607
 653:                5022676835
 655:                   8421335
 659:                   6959699
 661:                 193849487
 667:                     51359
 669:                3211164543
 671:                   5669279
 673:                 141070895
 677:                  96850943
 683:                  13081499
 685:                  39003215
 687:               24319371999
 689:                   3700619
 691:                2710757759
 697:                    120581
 701:                  13287455
 707:                 140096999
 709:                 239110959
 713:                      4991
 715:                     29315
 719:                   3106799
 721:                    760655
 723:                  25603599
 727:                  23287991
 731:                    588455
 733:               78372051407
 737:                     22847
 739:                 107732159
 741:             7710848622399
 743:                   1659119
 749:                    265895
 751:                 187498415
 755:                    390335
 757:               49569379679
 761:                  87562943
 763:                1566265799
 767:                   1915199
 769:                   6514199
 773:                  11368511
 777:         31829232287552511
 779:                   2150819
 781:                     46079
 785:                  57872555
 787:                   1241099
 791:                  24205391
 793:                  30222023
 797:                   4452839
 799:                     90287
 803:                  16719263
 805:                      8855
 809:                   4587839
 811:                  11195855
 813:                 174550287
 815:                 240080255
 817:                      5719
 821:                 984624479
 823:                 105114383
 827:                   2055095
 829:                2596088939
 835:                   2048255
 839:                  14800799
 849:        261147917637896799
 851:                   6730559
 853:                 759786719
 857:                  13971671
 859:                 126325399
 863:                   9694079
 865:                1116663965
 869:                   6023039
 871:                  23176439
 877:               20271948839
 881:                   6994259
 883:                 603383039
 887:                 501737759
 889:                    162687
 893:                    895679
 899:                  12676799
 901:                     31535
 903:             2215225217919
 905:               45708573455
 907:                 285774839
 911:                  10801727
 913:                     20999
 917:                  42624911
 919:                 487842879
 921:               14970106227
 923:                   7366463
 929:                  33695759
 935:                       935
 937:               35847939959
 941:              326947004999
 943:                  30071327
 947:                6613769399
 949:                 306871487
 953:                   7274249
 955:                     73535
 959:                  13971671
 965:                1840311935
 967:                   4681247
 971:                 796578299
 977:               22824172799
 979:                   1097459
 983:                  60939119
 985:                    117215
 989:                    588455
 991:                1218027199
 997:               16070342903

Couldn't find values for the following multiples: 579 633 831 939 993
