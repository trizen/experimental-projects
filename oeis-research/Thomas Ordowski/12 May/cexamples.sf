#!/usr/bin/ruby


func isok(n) {
    var upto = n.ilog(3)

    1..upto -> all {|q|
        var t = powmod(q, (n-1)/2, n)
        (t == 1) || (t == n-1)
    }
}

func isok_strong(n) {
    var upto = n.ilog(3)

    1..upto -> all {|q|
        var t = powmod(q, (n-1)/2, n)
        (t == 1)
    }
}

var arr = [63542085102541, 2593071578729521, 8072818294413421, 32446040579997661, 495032720098981681, 1567766946934843021, 2243715650874353701, 3825123056546413051, 318665857834031151167461, 3317044064679887385961981]

say arr.grep(isok)
say arr.grep(isok_strong)

#say [619440406020833, 2095988771234401, 4364724604902481, 5087540155980241].grep(isok)
#say [619440406020833, 2095988771234401, 4364724604902481, 5087540155980241].grep(isok_strong)

var log2terms = [    399001, 488881, 1615681, 1857241, 3057601, 3581761, 3828001, 5148001, 5968873, 6189121, 9439201, 10024561, 14469841, 14676481, 15829633, 17098369, 17236801, 23382529, 37964809, 38151361, 38624041, 42490801, 43331401, 45877861, 45890209, 50201089, 56052361, 62756641, 65241793, 68154001, 78091201, 79411201, 83966401, 84350561, 90698401, 92625121, 99036001]

say log2terms.all(isok)
say log2terms.all(isok_strong)

var log3terms = [

    1729, 46657, 75361, 162401, 399001, 488881, 530881, 1615681, 1857241, 2113921, 2433601, 3057601, 3581761, 3828001, 5148001, 5968873, 6189121, 9439201, 9613297, 10024561, 12490201, 14469841, 14676481, 15829633, 17098369, 17236801, 20964961, 23382529, 37964809, 38151361, 38624041, 40622401, 40917241, 42490801, 43331401, 43584481, 45877861, 45890209, 50201089, 53245921, 55462177, 56052361, 58489201, 62756641, 65241793, 68154001, 78091201, 78120001, 79411201, 81926461, 83099521, 83966401, 84311569, 84350561, 90698401, 92625121, 99036001
]


#say log3terms.all(isok)
#say log3terms.all(isok_strong)

var a = [10203294688133, 25145275248133, 31584636614081, 35488761020833, 36715833944641, 286136026384801, 322007862682133, 619440406020833, 2095988771234401, 52182690020544533]

say a.all(isok)
say a.all(isok_strong)
