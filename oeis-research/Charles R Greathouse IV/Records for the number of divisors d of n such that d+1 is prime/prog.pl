#!/usr/bin/perl

# Position of records in A067513.
# https://oeis.org/A202727

# Where A067513(n) is defined as:
#   Number of divisors d of n such that d+1 is prime.

use 5.020;
use warnings;
use experimental qw(signatures);
use ntheory qw(primes factor divisors is_prime);

sub hamming_numbers ($limit, $primes) {

    my @h = (1);
    foreach my $p (@$primes) {
        foreach my $n (@h) {
            if ($n * $p <= $limit) {
                push @h, $n * $p;
            }
        }
    }

    return \@h;
}

#while(<DATA>) {
#    my (undef, $n) = split(' ');
#    say join(', ', factor($n));
#}

# Example: 5-smooth numbers bellow 100
my $h = hamming_numbers(10**9, primes(41));

#say "Found: $#$h";

my $k = 1;
my $max = -1;

foreach my $n(sort {$a <=> $b} @$h) {

    my $count = grep{ is_prime($_-1) } divisors($n);

    if ($count > $max) {
        say "$k $n";
        $max = $count;
        ++$k;
    }
}

__END__
1 1
2 2
3 4
4 12
5 36
6 60
7 120
8 180
9 360
10 540
11 720
12 1080
13 1260
14 1680
15 2160
16 2520
17 3780
18 5040
19 7560
20 10080
21 15120
22 25200
23 30240
24 45360
25 55440
26 60480
27 75600
28 85680
29 100800
30 110880
31 131040
32 166320
33 196560
34 257040
35 332640
36 393120
37 514080
38 655200
39 665280
40 786240
41 831600
42 982800
43 1108800
44 1285200
45 1310400
46 1441440
47 1663200
48 1965600
49 2162160
50 2827440
51 3326400
52 3603600
53 4324320
54 6652800
55 7207200
56 8648640
57 10810800
58 12972960
59 14414400
60 17297280
61 21621600
62 36756720
63 43243200
64 64864800
65 73513440
66 86486400
67 122522400
68 129729600
69 147026880
70 183783600
71 220540320
72 245044800
73 294053760
74 367567200
75 551350800
76 735134400
77 1102701600
78 1470268800
79 2205403200
80 2572970400
81 2940537600
82 3675672000
83 4190266080
84 4410806400
85 5145940800
86 6983776800
87 10291881600
88 13967553600
89 20583763200
90 20951330400
91 25362136800
92 27935107200
93 41902660800
94 48886437600
95 55870214400
96 69837768000
97 83805321600
98 97772875200
99 139675536000
100 146659312800
