#!/usr/bin/ruby

# a(n) is the smallest prime p > a(n-1), such that the reversal of p in all bases 2..n is composite, with a(1) = 2.

# The first 62 terms are:
#   2, 19, 59, 109, 137, 139, 593, 607, 769, 1019, 2131, 2137, 3931, 5843, 7723, 8423, 8573, 8999, 11801, 17327, 18679, 24623, 34261, 47317, 50627, 76579, 83873, 136559, 159059, 169019, 171427, 188927, 282847, 295187, 324449, 530203, 650359, 656989, 661217, 666599, 671893, 682049, 732761, 765461, 1071349, 1089239, 1099181, 2593259, 2793269, 2946961, 2969467, 4262149, 4442989, 4785623, 4945159, 5743819, 7353377, 8296943, 8546431, 8579251, 11380801, 12718033

# Alternative sequence, with p >= a(n-1):
#   2, 19, 59, 109, 137, 137, 593, 593, 769, 1019, 1019, 1019, 1019, 1019, 2137, 2137, 2137, 2137, 2137, 2137, 8573, 11801, 11801, 11801, 47317, 47317, 47317, 47317, 47317, 47317, 159059, 159059, 159059, 159059, 159059, 159059, 159059, 159059, 169019, 169019, 324449, 324449, 656989, 656989, 671893, 671893, 671893, 671893, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 1089239, 8546431, 8546431, 8546431, 8546431, 8546431, 8546431, 21808687, 21808687, 21808687, 21808687, 21808687, 21808687, 22248299, 22248299, 22248299, 27847793, 27847793, 27847793, 27847793, 27847793, 27847793, 27847793, 27847793, 27847793, 27847793, 27847793

func a(n, from=1) {
    var P = @(2..n)
    from..Inf -> first {|k|
        k.is_prime && P.all { k.flip(_).is_composite }
    }
}

var from = 1;
for n in (2..100) {
    say [n, from = a(n, from+1)]
}
