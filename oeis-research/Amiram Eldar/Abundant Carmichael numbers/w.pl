#!/usr/bin/perl

use 5.014;

use Math::GMPz;
use ntheory qw(forsemiprimes forprimes factor forsquarefree random_prime divisors gcd next_prime);
use Math::Prime::Util::GMP qw(mulint is_pseudoprime vecprod divint sqrtint vecprod is_carmichael);

#my $k = "495088126122885";
#my $k = "19976310800932286865";     # record
#my $k =  vecprod(3, 5, 17, 23, 29, 43, 53, 89, 113, 127, 157, 257);
#my $k = vecprod(3, 5, 17, 23, 29, 43, 53, 89, 113, 127, 157, 257, 353, 397, 449);
#my $k = vecprod(3, 5, 17, 23, 29, 53, 89, 197);
my $k = vecprod(5, 7, 13, 17, 19, 23, 67, 89, 163, 397);

#my $n = "97492561525843375414411984711690826244618218549082363628202417811869034234870968105413397502977";
#my $n = "13757974351340992129905979322929973774675683422410013622969215110517423192617";
#my $n = "52234871830682397528051095096592168454889536093098407992957223";
#my $n = "492998637615524101988528566254824872883187100795158385773434977471920563361414751";
#my $n = "343007266355769778384701673249549952892082965850160905177012001818058446029240481";
#my $n = "32570940991344830846076116786757514876773522188233729072893528656637375859598588354317";
#my $n = "1783678161425679359147266763387785520358862736924657051419350376424361065071938287397480735353585534563540084656470093";
#my $n = "786769380874976962176734303050188467034887840304275124846721199585748921910091029860031756177";
#my $n = "1611172416406363222443655272298918903139645660167379869658840681191970272250330666161";
#my $n = "213259970167095025136189836699535867809435285476249320300587187293474667197712227";
my $n = "132302608972725106481213756111922514019029287449453366533581473";

foreach my $d(divisors($n)) {
    my $t = mulint($k, $d);
    #if (is_pseudoprime($t, 2) and is_c) {
    if (is_carmichael($t)) {
        say $t;
    }
}

__END__
[5, 7, 13, 17, 19, 23, 67, 89, 163, 397, 1783]
[3, 5, 17, 23, 173, 929, 2237, 449153]
[3, 5, 17, 23, 107, 1882667, 3765329]
[3, 5, 23, 29, 53, 113, 197, 1042133]
[5, 7, 13, 17, 19, 23, 37, 89, 3019, 72469]
[3, 5, 17, 29, 53, 2003, 8849, 160373]
[3, 5, 17, 23, 89, 3329, 63617, 68993]
[5, 7, 13, 17, 19, 23, 67, 73, 89, 433, 7993]
[5, 7, 13, 17, 19, 23, 59, 73, 97, 739, 12739]
[3, 5, 17, 23, 83, 353, 10979]
[3, 5, 17, 23, 113, 173, 2753, 17340269]
[3, 5, 17, 23, 83, 353, 2663, 395429]
[3, 5, 17, 23, 113, 167, 2927, 9857]
[3, 5, 17, 23, 89, 347, 353, 947, 15137]
[3, 5, 17, 23, 89, 113, 233, 617, 1409]
[3, 5, 17, 23, 89, 113, 149, 3257, 3557]
[3, 5, 17, 23, 29, 197, 617, 1217, 46817]
[3, 5, 17, 23, 29, 53, 89, 197, 1086989]
