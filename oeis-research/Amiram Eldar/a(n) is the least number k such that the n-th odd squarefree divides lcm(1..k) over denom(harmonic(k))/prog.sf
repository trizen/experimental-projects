#!/usr/bin/ruby

# a(n) is the least index k such that the n-th odd squarefree number A056911(n) divides A110566(k).
# https://oeis.org/A338120

# Known (consecutive) terms:
#   1, 6, 20, 42, 33, 156, 20, 272, 342, 2058, 506, 377, 930, 77, 14406, 629, 162, 1640, 559, 2162, 4624, 1166, 110, 6498, 3422, 610, 342732, 4422, 506, 4970, 5256, 42, 6162, 6806

# Lower bounds for the next unknown terms:
#   a(35) > 10^7
#   a(39) > 2*10^6
#   a(40) > 2*10^6
#   a(50) > 2*10^6

var OS = 1000.by { .is_squarefree && .is_odd }

var lookup_OS = Hash()

OS.each_kv {|k,v|
    lookup_OS{v} = k+1
}

var a = 1
var b = 0
var table = Hash()

for k in (1..2e6) {     # takes ~24 minutes

    a = lcm(a, k)
    b += k.inv

    a / b.de -> squarefree_divisors.each {|d|
        table{lookup_OS{d}} := k if lookup_OS.has(d)
    }
}

table.keys.map{.to_i}.sort.each {|k|
    say "a(#{k}) = #{table{k}}"
}

__END__
a(1) = 1
a(2) = 6
a(3) = 20
a(4) = 42
a(5) = 33
a(6) = 156
a(7) = 20
a(8) = 272
a(9) = 342
a(10) = 2058
a(11) = 506
a(12) = 377
a(13) = 930
a(14) = 77
a(15) = 14406
a(16) = 629
a(17) = 162
a(18) = 1640
a(19) = 559
a(20) = 2162
a(21) = 4624
a(22) = 1166
a(23) = 110
a(24) = 6498
a(25) = 3422
a(26) = 610
a(27) = 342732
a(28) = 4422
a(29) = 506
a(30) = 4970
a(31) = 5256
a(32) = 42
a(33) = 6162
a(34) = 6806
a(36) = 13122
a(37) = 7832
a(38) = 2058
a(41) = 1067
a(42) = 10100
a(43) = 10506
a(44) = 14406
a(45) = 11342
a(46) = 2725
a(47) = 629
a(48) = 12656
a(49) = 506
a(51) = 1640
a(52) = 16002
a(53) = 559
a(54) = 17030
a(55) = 342
a(56) = 685
a(57) = 19182
a(58) = 2162
a(60) = 12615
a(61) = 22052
a(62) = 22650
a(64) = 24492
a(65) = 1590
a(67) = 26406
a(68) = 13310
a(69) = 27722
a(70) = 12283
a(72) = 31862
a(73) = 32580
a(74) = 610
a(75) = 1823508
a(76) = 4624
a(77) = 36290
a(78) = 37056
a(79) = 354294
a(80) = 38612
a(81) = 7562
a(82) = 4422
a(83) = 705894
a(84) = 67240
a(86) = 44310
a(87) = 4970
a(88) = 559
a(90) = 5256
a(92) = 49506
a(93) = 4994
a(94) = 52212
a(95) = 14406
a(96) = 54056
a(98) = 6162
a(99) = 56882
a(100) = 57840
a(103) = 62750
a(106) = 16962
a(108) = 68906
a(109) = 2756
a(111) = 8877
a(112) = 15718
a(113) = 2058
a(114) = 76452
a(115) = 78680
a(116) = 79806
a(120) = 85556
a(125) = 610
a(126) = 93942
a(127) = 1082118
a(128) = 96410
a(129) = 32865
a(130) = 100172
a(131) = 377
a(132) = 1213594
a(134) = 4796
a(135) = 2162
a(136) = 109230
a(138) = 113232
a(139) = 1430128
a(140) = 930
a(141) = 506
a(142) = 21861
a(143) = 121452
a(144) = 42007
a(145) = 352870
a(147) = 128522
a(148) = 383688
a(149) = 134322
a(151) = 138756
a(152) = 365835
a(153) = 55334
a(154) = 16002
a(155) = 146306
a(156) = 14406
a(157) = 150932
a(159) = 17030
a(161) = 13895
a(163) = 30476
a(165) = 49284
a(166) = 49080
a(167) = 685
a(170) = 19182
a(171) = 175142
a(172) = 85042
a(175) = 185330
a(176) = 50228
a(177) = 13122
a(179) = 93507
a(180) = 195806
a(183) = 201152
a(187) = 208392
a(188) = 212060
a(189) = 213906
a(191) = 217622
a(194) = 1247
a(195) = 228962
a(196) = 26364
a(199) = 236682
a(201) = 240590
a(204) = 248502
a(206) = 252506
a(208) = 6108
a(211) = 102487
a(212) = 17473
a(213) = 14067
a(214) = 273006
a(219) = 292140
a(221) = 2725
a(222) = 298662
a(226) = 309692
a(228) = 4624
a(229) = 316406
a(230) = 12656
a(231) = 323192
a(232) = 325470
a(234) = 13848
a(237) = 1210
a(238) = 343982
a(241) = 351056
a(243) = 39402
a(244) = 42529
a(245) = 116594
a(246) = 367842
a(248) = 2162
a(249) = 375156
a(251) = 61083
a(252) = 382542
a(256) = 397530
a(257) = 44310
a(259) = 123072
a(260) = 140174
a(261) = 559
a(262) = 61465
a(265) = 425756
a(267) = 67877
a(268) = 436260
a(271) = 11638
a(272) = 49506
a(274) = 452256
a(275) = 50775
a(276) = 103499
a(277) = 4994
a(278) = 465806
a(280) = 52212
a(282) = 476790
a(285) = 54056
a(286) = 490700
a(290) = 501972
a(293) = 56882
a(294) = 516242
a(296) = 57840
a(297) = 527802
a(298) = 78608
a(299) = 234560
a(300) = 4422
a(301) = 545382
a(303) = 551306
a(306) = 563250
a(309) = 572292
a(311) = 6088
a(312) = 760384
a(314) = 590592
a(315) = 16962
a(316) = 107447
a(319) = 4970
a(321) = 618582
a(326) = 634412
a(328) = 5256
a(331) = 50967
a(332) = 656910
a(333) = 15718
a(336) = 321832
a(337) = 676506
a(338) = 120742
a(339) = 686412
a(342) = 319659
a(346) = 726756
a(347) = 733592
a(348) = 737022
a(350) = 9493
a(352) = 486798
a(354) = 768252
a(356) = 775280
a(357) = 778806
a(359) = 785882
a(360) = 16002
a(368) = 821742
a(369) = 42817
a(370) = 564898
a(371) = 610
a(373) = 11947
a(375) = 352870
a(376) = 158859
a(379) = 163038
a(381) = 49873
a(383) = 257584
a(386) = 202036
a(388) = 13310
a(389) = 100842
a(391) = 934122
a(393) = 252460
a(395) = 953552
a(397) = 965306
a(399) = 2162
a(401) = 981090
a(404) = 993012
a(409) = 434879
a(411) = 1025156
a(413) = 38722
a(414) = 1041420
a(417) = 271153
a(418) = 1066056
a(420) = 1078482
a(421) = 120062
a(424) = 121452
a(425) = 14686
a(426) = 301637
a(429) = 42007
a(430) = 1124660
a(431) = 1128906
a(432) = 354294
a(433) = 9317
a(434) = 213800
a(435) = 23548
a(436) = 128522
a(440) = 429365
a(441) = 1189190
a(442) = 298389
a(443) = 383688
a(444) = 1202312
a(446) = 134322
a(447) = 1215506
a(449) = 1228772
a(450) = 10100
a(453) = 15638
a(454) = 138756
a(456) = 406526
a(457) = 1273512
a(458) = 365835
a(459) = 10506
a(461) = 55334
a(465) = 893730
a(466) = 146306
a(467) = 216388
a(468) = 342441
a(469) = 14406
a(472) = 1351406
a(474) = 150932
a(476) = 210780
a(478) = 1213594
a(479) = 1393580
a(481) = 231465
a(483) = 13895
a(484) = 1422056
a(486) = 4796
a(487) = 1441200
a(488) = 129924
a(493) = 405142
a(494) = 702209
a(496) = 49284
a(497) = 1494506
a(498) = 49080
a(499) = 1509212
a(500) = 323753
a(502) = 1528932
a(507) = 24037
a(508) = 1558752
a(510) = 62750
a(511) = 175142
a(512) = 742810
a(514) = 176820
a(519) = 1629452
a(520) = 1634562
a(522) = 1644806
a(523) = 65792
a(524) = 290025
a(525) = 1665390
a(528) = 46692
a(529) = 50228
a(530) = 809222
a(531) = 298387
a(532) = 415626
a(536) = 68906
a(538) = 539471
a(539) = 1743720
a(540) = 529473
a(547) = 63215
a(552) = 73170
a(554) = 198706
a(557) = 1867322
a(559) = 437987
a(561) = 638022
a(563) = 76452
a(569) = 1955802
a(574) = 669275
a(577) = 368311
a(578) = 53621
a(579) = 95341
a(580) = 831941
a(581) = 511582
a(582) = 280868
a(585) = 54682
a(588) = 988301
a(589) = 232160
a(607) = 234401
a(613) = 102487
a(620) = 6108
a(622) = 202092
a(627) = 523077
a(630) = 528209
a(632) = 69885
a(634) = 929164
a(636) = 14067
a(637) = 64791
a(638) = 714552
a(641) = 6806
a(647) = 24037
a(648) = 13310
a(658) = 780358
a(664) = 368311
a(665) = 168611
a(674) = 420878
a(690) = 709346
a(700) = 666801
a(703) = 13848
a(704) = 875165
a(711) = 146410
a(722) = 360731
a(728) = 338121
a(731) = 42529
a(734) = 139432
a(739) = 367842
a(740) = 1268808
a(743) = 2162
a(746) = 375156
a(750) = 380072
a(751) = 4796
a(753) = 382542
a(758) = 1586608
a(760) = 1139339
a(763) = 365835
a(767) = 397530
a(769) = 15718
a(775) = 769026
a(779) = 123072
a(781) = 140174
a(786) = 356497
a(791) = 577496
a(794) = 425756
a(801) = 365745
a(802) = 253312
a(804) = 436260
a(805) = 13895
a(806) = 387465
a(810) = 928605
a(811) = 1443278
a(813) = 1626436
a(818) = 1702348
a(819) = 452256
a(822) = 361162
a(823) = 50775
a(831) = 465806
a(841) = 476790
a(847) = 1729692
a(851) = 736749
a(853) = 490700
a(857) = 92972
a(858) = 383688
a(859) = 26406
a(862) = 501972
a(863) = 1733006
a(866) = 961650
a(873) = 1065735
a(875) = 516242
a(877) = 1949222
a(881) = 27722
a(882) = 1640
a(885) = 527802
a(895) = 132420
a(896) = 4422
a(907) = 823216
a(916) = 629
a(920) = 364987
a(926) = 6088
a(928) = 1861618
a(937) = 415980
a(939) = 109230
a(940) = 489309
a(941) = 44310
a(945) = 1369471
a(950) = 4970
a(957) = 113232
a(964) = 1991926
a(974) = 722099
a(977) = 5256
a(981) = 899124
a(983) = 918317
a(984) = 50967
a(996) = 49506
a(1005) = 160745
a(1008) = 120742
a(1015) = 4994
a(1019) = 11772
a(1023) = 383423
a(1024) = 52212
a(1036) = 519071
a(1039) = 54056
a(1046) = 697048
a(1055) = 14067
a(1056) = 486798
a(1062) = 123187
a(1065) = 56882
a(1074) = 57840
a(1081) = 16002
a(1090) = 467886
a(1106) = 467001
a(1107) = 42817
a(1114) = 544302
a(1123) = 354294
a(1129) = 158859
a(1130) = 75303
a(1138) = 163038
a(1140) = 316406
a(1143) = 49873
a(1144) = 48830
a(1151) = 366747
a(1152) = 323192
a(1156) = 325470
a(1167) = 13848
a(1171) = 880688
a(1178) = 424327
a(1180) = 93344
a(1184) = 471247
a(1188) = 343982
a(1196) = 129932
a(1201) = 351056
a(1207) = 57452
a(1213) = 315673
a(1215) = 897299
a(1217) = 360600
a(1218) = 903264
a(1226) = 434879
a(1229) = 367842
a(1239) = 39366
a(1243) = 375156
a(1251) = 318989
a(1255) = 382542
a(1259) = 11342
a(1277) = 14686
a(1283) = 11772
a(1311) = 356497
a(1318) = 907029
a(1323) = 429365
a(1329) = 12656
a(1336) = 67877
a(1360) = 15638
a(1368) = 406526
a(1372) = 914837
a(1376) = 864195
a(1384) = 122652
a(1394) = 999003
a(1431) = 324484
a(1453) = 121822
a(1456) = 903264
a(1459) = 4796
a(1469) = 102487
a(1477) = 405142
a(1478) = 109230
a(1480) = 14406
a(1491) = 528624
a(1505) = 113232
a(1525) = 857508
a(1570) = 491109
a(1578) = 46692
a(1591) = 415626
a(1592) = 254995
a(1612) = 812
a(1615) = 529473
a(1636) = 986123
a(1639) = 14406
a(1666) = 321832
a(1671) = 437987
a(1674) = 330160
a(1679) = 488402
a(1691) = 55334
a(1702) = 319659
a(1705) = 193246
a(1706) = 116594
a(1709) = 146410
a(1724) = 368311
a(1733) = 593947
a(1734) = 2162
a(1735) = 150932
a(1739) = 511582
a(1744) = 437065
a(1752) = 54682
a(1756) = 636069
a(1771) = 13895
a(1790) = 160400
a(1817) = 573568
a(1824) = 49080
a(1849) = 103499
a(1864) = 12500
a(1873) = 352870
a(1878) = 523077
a(1886) = 528209
a(1932) = 50228
a(1938) = 78680
a(1941) = 13310
a(1952) = 79806
a(1973) = 315965
a(1993) = 168611
a(2016) = 420878
a(2054) = 703
a(2118) = 11638
a(2126) = 14686
a(2161) = 360731
a(2174) = 29756
a(2194) = 107447
a(2201) = 744047
a(2242) = 625003
a(2252) = 4796
a(2292) = 365835
a(2306) = 15718
a(2323) = 14067
a(2338) = 342441
a(2342) = 2756
a(2356) = 24492
a(2405) = 376010
a(2412) = 321462
a(2413) = 13895
a(2416) = 387465
a(2420) = 726756
a(2432) = 733592
a(2433) = 82249
a(2438) = 737022
a(2444) = 26406
a(2448) = 734413
a(2468) = 361162
a(2489) = 768252
a(2496) = 323753
a(2501) = 775280
a(2506) = 778806
a(2518) = 785882
a(2572) = 13848
a(2573) = 821742
a(2574) = 383688
a(2585) = 786193
a(2606) = 3422
a(2609) = 101614
a(2643) = 1640
a(2661) = 713994
a(2670) = 11577
a(2672) = 733980
a(2682) = 116594
a(2686) = 132420
a(2704) = 705894
a(2719) = 124256
a(2736) = 24492
a(2745) = 629
a(2754) = 393994
a(2757) = 364987
a(2765) = 128522
a(2769) = 355316
a(2805) = 415980
a(2818) = 44310
a(2855) = 149353
a(2869) = 368311
a(2887) = 64161
a(2923) = 790777
a(2957) = 297025
a(2974) = 14686
a(2980) = 801913
a(2981) = 49506
a(3005) = 160745
a(3017) = 50775
a(3027) = 103499
a(3036) = 4994
a(3064) = 52212
a(3084) = 751117
a(3089) = 129924
a(3093) = 343982
a(3111) = 519071
a(3118) = 54056
a(3126) = 351056
a(3127) = 490700
a(3150) = 69885
a(3158) = 358202
a(3163) = 501972
a(3169) = 360600
a(3170) = 14067
a(3172) = 15638
a(3190) = 123187
a(3200) = 56882
a(3201) = 367842
a(3209) = 516242
a(3224) = 57840
a(3242) = 527802
a(3270) = 536556
a(3272) = 467886
a(3295) = 545382
a(3315) = 551306
a(3322) = 467001
a(3347) = 49506
a(3351) = 563250
a(3377) = 572292
a(3396) = 560857
a(3411) = 356497
a(3418) = 134896
a(3430) = 590592
a(3438) = 48830
a(3448) = 107447
a(3455) = 777663
a(3458) = 366747
a(3475) = 365745
a(3499) = 655804
a(3510) = 13848
a(3511) = 618582
a(3557) = 634412
a(3562) = 471247
a(3576) = 742810
a(3595) = 129932
a(3604) = 360731
a(3605) = 755395
a(3611) = 50967
a(3629) = 57452
a(3630) = 338121
a(3644) = 358202
a(3656) = 360600
a(3675) = 326124
a(3690) = 562360
a(3692) = 491562
a(3693) = 367842
a(3694) = 809222
a(3730) = 375156
a(3755) = 380072
a(3767) = 382542
a(3846) = 368311
a(3851) = 9493
a(3921) = 6498
a(3936) = 356497
a(4010) = 365745
a(4014) = 376010
a(4031) = 387465
a(4065) = 54056
a(4115) = 361162
a(4146) = 158859
a(4147) = 122652
a(4168) = 308190
a(4198) = 49873
a(4226) = 594716
a(4277) = 102487
a(4292) = 383688
a(4328) = 351388
a(4331) = 517543
a(4353) = 783947
a(4358) = 121822
a(4371) = 68906
a(4435) = 14406
a(4448) = 714552
a(4464) = 528624
a(4500) = 582193
a(4590) = 780358
a(4591) = 364987
a(4770) = 37210
a(4812) = 709346
a(4855) = 270920
a(4868) = 38612
a(4871) = 596778
a(4873) = 273006
a(4896) = 78680
a(4910) = 14406
a(4919) = 39402
a(4934) = 123462
a(4978) = 518288
a(5032) = 488402
a(5040) = 719685
a(5066) = 55334
a(5099) = 383423
a(5119) = 146410
a(5198) = 2162
a(5201) = 150932
a(5222) = 928008
a(5307) = 13895
a(5361) = 160400
a(5385) = 103499
a(5391) = 62750
a(5408) = 579814
a(5425) = 769026
a(5468) = 49080
a(5613) = 354294
a(5614) = 39725
a(5653) = 75303
a(5747) = 491109
a(5763) = 366747
a(5781) = 63215
a(5784) = 46692
a(5793) = 50228
a(5860) = 6498
a(5881) = 539471
a(5918) = 529473
a(5958) = 736749
a(5995) = 272632
a(6076) = 342732
a(6134) = 49284
a(6158) = 638022
a(6165) = 703
a(6262) = 732724
a(6294) = 85556
a(6347) = 823216
a(6372) = 511582
a(6377) = 14686
a(6407) = 368311
a(6416) = 54682
a(6495) = 50228
a(6533) = 4994
a(6555) = 822716
a(6606) = 55334
a(6642) = 12656
a(6688) = 323192
a(6712) = 325470
a(6782) = 318504
a(6808) = 722099
a(6882) = 523077
a(6908) = 528209
a(6924) = 573057
a(6969) = 14067
a(7135) = 367842
a(7147) = 324484
a(7205) = 375156
a(7208) = 533490
a(7252) = 318989
a(7277) = 382542
a(7300) = 491100
a(7394) = 14406
a(7718) = 13848
a(7746) = 365835
a(8065) = 764767
a(8155) = 124256
a(8184) = 14406
a(8226) = 146306
a(8258) = 393994
a(8260) = 4796
a(8292) = 128522
a(8308) = 355316
a(8360) = 330160
a(8567) = 11947
a(8574) = 149353
a(8616) = 368311
a(8701) = 577496
a(8853) = 13895
a(8930) = 14686
a(9044) = 85042
a(9056) = 50775
a(9265) = 129924
a(9366) = 360731
a(9378) = 490700
a(9472) = 358202
a(9487) = 501972
a(9505) = 360600
a(9513) = 15638
a(9600) = 367842
a(9617) = 271153
a(9622) = 516242
a(9655) = 321832
a(9725) = 683102
a(9727) = 527802
a(9747) = 686412
a(9855) = 315965
a(9864) = 319659
