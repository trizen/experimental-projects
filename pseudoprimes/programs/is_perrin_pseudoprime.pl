#!/usr/bin/perl

# Find large Perrin pseudoprimes that are not Carmichael numbers.

use 5.020;
use strict;
use warnings;
use experimental qw(signatures);

use Math::Prime::Util::GMP qw(is_perrin_pseudoprime is_carmichael);

while (<>) {
    next if /^\h*#/;
    /\S/ or next;

    my $n = (split(' ', $_))[-1];
    $n || next;

    next if $n < ~0;

    if (is_perrin_pseudoprime($n)) {
        say $n if !is_carmichael($n);
    }
}

__END__

# Several Perrin pseudoprimes (>2^64) that are not Carmichael numbers:

22192136014448227741
25893854852593099681
35544190212470391157
37472534262502339001
42040681254868350601
47661028937545023901
97926423759582775657
109052886646067003641
136921669996284733201
185713044105994936441
208089137879432709661
324217750194969974281
476610134346679626001
879497638355816551261
994539714500643524921
1074723627475184459693
1355894318853426424669
2121507859827857553361
2594068143168695305141
3177998428694514380801
5519475650351358289441
6220900587876007766041
7558974222719472825841
